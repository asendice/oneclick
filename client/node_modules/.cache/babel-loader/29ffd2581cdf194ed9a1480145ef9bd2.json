{"ast":null,"code":"import _toConsumableArray from\"/Users/dylantravis/Desktop/finalPush/oneclick/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/dylantravis/Desktop/finalPush/oneclick/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import MatchDisplay from\"./MatchDisplay\";import CsvHeader from\"./CsvHeader\";import LoadingHeaders from\"./LoadingHeaders\";import{Redirect,Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Match=function Match(_ref){var file=_ref.file,data=_ref.data,backEndHeaders=_ref.backEndHeaders,setData=_ref.setData,setFrame=_ref.setFrame;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),matched=_useState2[0],setMatched=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),headers=_useState4[0],setHeaders=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),errorRows=_useState6[0],setErrorRows=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),remainingHeaders=_useState8[0],setRemainingHeaders=_useState8[1];useEffect(function(){if(headers.length>0){var unMatched=headers.filter(function(header){return header.confirmed===false;});if(unMatched.length===0){setMatched(true);}var headerNames=headers.map(function(header){return header.matchedWith;});setRemainingHeaders(backEndHeaders.filter(function(item){return!headerNames.includes(item.name);}));}},[headers]);useEffect(function(){var rowsWithMissingValues=data.filter(function(row){return Object.keys(row).some(function(prop){return row[prop]===\"\";});});setErrorRows(rowsWithMissingValues);},[data]);useEffect(function(){if(data.length>0){var createHeaders=Object.keys(data[0]).map(function(header,index){// values might be not necessary\nvar values=data.map(function(row){return row[header];});var obj={index:index,name:header,matchedWith:\"\",confirmed:false,values:values};return obj;});headerMatch(createHeaders);}},[data]);var headerMatch=function headerMatch(list){var matching=list.map(function(header){var backendMatch=backEndHeaders.filter(function(item){return header.name===item.name||item.altNames.includes(header.name);});header.matchedWith=backendMatch[0]?backendMatch[0].name:\"\";return header;});setHeaders(matching);};var confirmHeader=function confirmHeader(header,index){header.name=header.matchedWith;header.confirmed=true;var arr=_toConsumableArray(headers);arr.splice(index,1,header);setHeaders(arr);};var onReviewClick=function onReviewClick(){var filteredForErrors=data.filter(function(row){return!errorRows.includes(row);});var headerNames=headers.map(function(header){return header.name;});var updatedData=filteredForErrors.map(function(row,index){Object.keys(row).map(function(key,index){if(headerNames[index]!==key){row[headerNames[index]]=row[key];delete row[key];}});return row;});setData(updatedData);setFrame(\"Review\");};if(file){return/*#__PURE__*/_jsxs(\"div\",{className:\"match\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"match-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:file.name}),/*#__PURE__*/_jsx(\"div\",{children:matched&&/*#__PURE__*/_jsx(Link,{to:\"/review\",style:{textDecoration:\"none\"},className:\"trove-button\",onClick:function onClick(){return onReviewClick();},children:\"Review\"})})]}),/*#__PURE__*/_jsx(MatchDisplay,{headers:headers,errorRows:errorRows,dataLength:data.length,file:file}),/*#__PURE__*/_jsx(\"div\",{className:\"match-main\",children:headers.length>0?headers.map(function(header,index){return/*#__PURE__*/_jsx(CsvHeader,{header:header,headers:headers,setHeaders:setHeaders,confirmHeader:confirmHeader,dropDownData:remainingHeaders},index);}):/*#__PURE__*/_jsx(LoadingHeaders,{})})]});}else{return/*#__PURE__*/_jsx(Redirect,{to:\"/\"});}};export default Match;","map":{"version":3,"sources":["/Users/dylantravis/Desktop/finalPush/oneclick/client/src/components/Match.js"],"names":["React","useEffect","useState","MatchDisplay","CsvHeader","LoadingHeaders","Redirect","Link","Match","file","data","backEndHeaders","setData","setFrame","matched","setMatched","headers","setHeaders","errorRows","setErrorRows","remainingHeaders","setRemainingHeaders","length","unMatched","filter","header","confirmed","headerNames","map","matchedWith","item","includes","name","rowsWithMissingValues","row","Object","keys","some","prop","createHeaders","index","values","obj","headerMatch","list","matching","backendMatch","altNames","confirmHeader","arr","splice","onReviewClick","filteredForErrors","updatedData","key","textDecoration"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport MatchDisplay from \"./MatchDisplay\";\nimport CsvHeader from \"./CsvHeader\";\nimport LoadingHeaders from \"./LoadingHeaders\";\nimport { Redirect, Link } from \"react-router-dom\";\n\nconst Match = ({ file, data, backEndHeaders, setData, setFrame }) => {\n  const [matched, setMatched] = useState(false);\n  const [headers, setHeaders] = useState([]);\n  const [errorRows, setErrorRows] = useState([]);\n  const [remainingHeaders, setRemainingHeaders] = useState([]);\n\n  useEffect(() => {\n    if (headers.length > 0) {\n      const unMatched = headers.filter((header) => header.confirmed === false);\n      if (unMatched.length === 0) {\n        setMatched(true);\n      }\n      const headerNames = headers.map((header) => header.matchedWith);\n      setRemainingHeaders(\n        backEndHeaders.filter((item) => !headerNames.includes(item.name))\n      );\n    }\n  }, [headers]);\n\n  useEffect(() => {\n    const rowsWithMissingValues = data.filter((row) => {\n      return Object.keys(row).some((prop) => row[prop] === \"\");\n    });\n    setErrorRows(rowsWithMissingValues);\n  }, [data]);\n\n  useEffect(() => {\n    if (data.length > 0) {\n      const createHeaders = Object.keys(data[0]).map((header, index) => {\n        // values might be not necessary\n        const values = data.map((row) => {\n          return row[header];\n        });\n        const obj = {\n          index: index,\n          name: header,\n          matchedWith: \"\",\n          confirmed: false,\n          values: values,\n        };\n        return obj;\n      });\n      headerMatch(createHeaders);\n    }\n  }, [data]);\n\n  const headerMatch = (list) => {\n    const matching = list.map((header) => {\n      const backendMatch = backEndHeaders.filter((item) => {\n        return header.name === item.name || item.altNames.includes(header.name);\n      });\n      header.matchedWith = backendMatch[0] ? backendMatch[0].name : \"\";\n      return header;\n    });\n    setHeaders(matching);\n  };\n\n  const confirmHeader = (header, index) => {\n    header.name = header.matchedWith;\n    header.confirmed = true;\n    let arr = [...headers];\n    arr.splice(index, 1, header);\n    setHeaders(arr);\n  };\n\n  const onReviewClick = () => {\n    const filteredForErrors = data.filter((row) => !errorRows.includes(row));\n    const headerNames = headers.map((header) => header.name);\n    const updatedData = filteredForErrors.map((row, index) => {\n      Object.keys(row).map((key, index) => {\n        if (headerNames[index] !== key) {\n          row[headerNames[index]] = row[key];\n          delete row[key];\n        }\n      });\n      return row;\n    });\n    setData(updatedData);\n    setFrame(\"Review\");\n  };\n\n  if (file) {\n    return (\n      <div className=\"match\">\n        <div className=\"match-header\">\n          <h3>{file.name}</h3>\n          <div>\n            {matched && (\n              <Link\n                to=\"/review\"\n                style={{ textDecoration: \"none\"}}\n                className=\"trove-button\"\n                onClick={() => onReviewClick()}\n              >\n                Review\n              </Link>\n            )}\n          </div>\n        </div>\n        <MatchDisplay\n          headers={headers}\n          errorRows={errorRows}\n          dataLength={data.length}\n          file={file}\n        />\n        <div className=\"match-main\">\n          {headers.length > 0 ? (\n            headers.map((header, index) => {\n              return (\n                <CsvHeader\n                  key={index}\n                  header={header}\n                  headers={headers}\n                  setHeaders={setHeaders}\n                  confirmHeader={confirmHeader}\n                  dropDownData={remainingHeaders}\n                />\n              );\n            })\n          ) : (\n            <LoadingHeaders />\n          )}\n        </div>\n      </div>\n    );\n  } else {\n    return <Redirect to=\"/\" />;\n  }\n};\n\nexport default Match;\n"]},"metadata":{},"sourceType":"module"}